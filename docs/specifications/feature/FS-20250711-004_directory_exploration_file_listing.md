---
status: Approved
---
# 기능 명세 (Feature Specification)

*   **문서 ID**: `FS-20250711-004`
*   **작성일**: `2025년 07월 14일`
*   **작성자**: `Gemini (PM)`
*   **기능명**: `디렉토리 탐색 및 파일 목록 표시`

---

### 1. 개요 (Overview)

이 기능은 사용자가 FileTagger 애플리케이션에서 디렉토리 구조를 탐색하고, 선택된 디렉토리의 파일 목록을 표시할 수 있도록 합니다. 디렉토리 트리를 통해 계층적 구조를 시각적으로 탐색할 수 있으며, 다양한 필터링 옵션을 통해 원하는 파일들만 선택적으로 표시할 수 있습니다. 이 기능은 파일 태깅 작업의 기반이 되는 파일 탐색 및 선택 기능을 제공합니다.

### 2. 주요 기능 상세 (Detailed Functional Description)

*   **2.1. 기능 설명**:
    *   **디렉토리 트리 탐색**: `DirectoryTreeWidget`을 통해 파일 시스템의 계층적 구조를 트리 형태로 표시합니다. 사용자는 폴더를 확장/축소하여 하위 디렉토리로 이동할 수 있습니다.
    *   **디렉토리 선택**: 트리에서 디렉토리를 클릭하면 해당 디렉토리가 선택되고, `FileListWidget`에 해당 디렉토리의 파일 목록이 표시됩니다.
    *   **파일 목록 표시**: 선택된 디렉토리의 파일들을 테이블 형태로 표시하며, 파일명, 상대 경로, 현재 적용된 태그 정보를 포함합니다.
    *   **필터링 옵션**: 재귀 검색, 파일 확장자 필터, 태그 기반 필터링을 통해 원하는 파일들만 선택적으로 표시할 수 있습니다.
    *   **전역 파일 검색**: 작업 공간 전체에서 파일명을 기반으로 검색할 수 있는 기능을 제공합니다.

*   **2.2. 입력/출력**:
    *   **입력**:
        *   사용자가 클릭한 디렉토리 경로
        *   필터링 옵션 (재귀 여부, 파일 확장자, 태그 검색어)
        *   전역 파일 검색어
    *   **출력**:
        *   선택된 디렉토리의 파일 목록 (테이블 형태)
        *   파일별 태그 정보
        *   상태바 메시지 (선택된 디렉토리 정보)
        *   필터링된 파일 목록

*   **2.3. 정상 흐름**:
    1.  사용자가 `DirectoryTreeWidget`에서 디렉토리를 클릭합니다.
    2.  `MainWindow.on_directory_selected()` 메서드가 호출되어 클릭된 항목의 정보를 분석합니다.
    3.  클릭된 항목이 디렉토리인지 파일인지 확인합니다.
    4.  **디렉토리 선택 시**:
        *   현재 설정된 필터 옵션(재귀, 파일 확장자)을 가져옵니다.
        *   `FileListWidget.set_path()`를 호출하여 해당 디렉토리의 파일 목록을 표시합니다.
        *   `FileDetailWidget.clear_preview()`를 호출하여 파일 상세 정보를 초기화합니다.
        *   `TagControlWidget.update_for_target()`을 호출하여 일괄 태깅 모드로 전환합니다.
        *   상태바에 디렉토리 선택 메시지를 표시합니다.
    5.  **파일 선택 시**:
        *   `FileDetailWidget.update_preview()`를 호출하여 파일 상세 정보를 표시합니다.
        *   `TagControlWidget.update_for_target()`을 호출하여 개별 태깅 모드로 전환합니다.
        *   `FileListWidget`에서 해당 파일을 자동으로 선택합니다.
        *   상태바에 파일 선택 메시지를 표시합니다.
    6.  **필터 옵션 변경 시**:
        *   `_on_directory_tree_filter_options_changed()` 메서드가 호출됩니다.
        *   현재 선택된 디렉토리를 기준으로 새로운 필터 옵션을 적용합니다.
        *   파일 목록, 상세 정보, 태그 제어 위젯을 초기화합니다.
        *   상태바에 필터 변경 메시지를 표시합니다.

*   **2.4. 예외 처리**:
    *   **디렉토리 접근 오류**: 선택된 디렉토리에 접근할 수 없는 경우 오류 메시지를 표시하고 이전 상태를 유지합니다.
    *   **파일 목록 로딩 실패**: 파일 목록을 가져오는 과정에서 오류가 발생할 경우 빈 목록을 표시하고 오류 메시지를 상태바에 표시합니다.
    *   **필터 적용 실패**: 필터링 과정에서 오류가 발생할 경우 기본 필터를 적용하고 오류 메시지를 표시합니다.
    *   **메모리 부족**: 대용량 디렉토리 처리 시 메모리 부족이 발생할 경우 파일 수를 제한하고 경고 메시지를 표시합니다.

### 3. UI/UX 요소 (UI/UX Elements)

*   **DirectoryTreeWidget**:
    *   **트리 뷰**: 파일 시스템 구조를 계층적으로 표시하는 `QTreeView` 위젯
    *   **전역 파일 검색 입력란**: 작업 공간 전체에서 파일을 검색할 수 있는 `QLineEdit`
    *   **태그 검색 입력란**: 태그 기반으로 파일을 필터링할 수 있는 `QLineEdit`
    *   **확장자 필터**: 특정 파일 확장자만 표시할 수 있는 `QLineEdit`
    *   **파일 표시 옵션**: 디렉토리 뷰에 파일을 표시할지 여부를 결정하는 체크박스
    *   **재귀 검색 옵션**: 하위 폴더를 포함하여 검색할지 여부를 결정하는 체크박스
*   **FileListWidget**:
    *   **테이블 뷰**: 파일 목록을 테이블 형태로 표시하는 `QTableView`
    *   **컬럼**: 파일명, 경로, 태그 정보를 표시하는 컬럼들
    *   **다중 선택**: Ctrl/Cmd 키를 사용한 다중 파일 선택 지원
*   **상태바**: 현재 선택된 디렉토리 정보 및 작업 상태를 표시

### 4. 기술적 구현 (Technical Implementation)

*   **DirectoryTreeWidget**:
    *   `QFileSystemModel`: 파일 시스템 구조를 모델링하는 Qt 모델
    *   `QSortFilterProxyModel`: 트리 뷰의 필터링 및 정렬을 담당하는 프록시 모델
    *   `set_root_path()`: 트리 뷰의 루트 경로를 설정하는 메서드
    *   `_update_tree_view_filter()`: 트리 뷰의 필터 옵션을 업데이트하는 메서드
    *   `_emit_filter_options_changed()`: 필터 옵션 변경 시그널을 방출하는 메서드
*   **FileListWidget**:
    *   `FileTableModel`: 파일 정보와 태그 정보를 함께 표시하는 커스텀 테이블 모델
    *   `set_path()`: 지정된 경로의 파일 목록을 표시하는 메서드
    *   `set_tag_filter()`: 태그 기반 필터링을 적용하는 메서드
    *   `set_search_results()`: 전역 검색 결과를 표시하는 메서드
    *   `get_selected_file_paths()`: 현재 선택된 파일들의 경로를 반환하는 메서드
*   **MainWindow**:
    *   `on_directory_selected()`: 디렉토리 선택 이벤트를 처리하는 메서드
    *   `_on_directory_tree_filter_options_changed()`: 필터 옵션 변경 이벤트를 처리하는 메서드
    *   `on_global_file_search_requested()`: 전역 파일 검색 요청을 처리하는 메서드
*   **TagManager**:
    *   `get_files_in_directory()`: 지정된 디렉토리의 파일 목록을 가져오는 메서드
    *   `get_tags_for_file()`: 특정 파일의 태그 정보를 가져오는 메서드

### 5. 테스트 케이스 (Test Cases)

*   **TC-FS-026**: 디렉토리 트리에서 디렉토리를 클릭했을 때 해당 디렉토리의 파일 목록이 표시되는지 확인
*   **TC-FS-027**: 디렉토리 트리에서 파일을 클릭했을 때 파일 상세 정보가 표시되는지 확인
*   **TC-FS-028**: 재귀 검색 옵션을 활성화했을 때 하위 폴더의 파일들도 포함되어 표시되는지 확인
*   **TC-FS-029**: 파일 확장자 필터를 적용했을 때 해당 확장자의 파일들만 표시되는지 확인
*   **TC-FS-030**: 태그 검색을 통해 특정 태그가 있는 파일들만 필터링되는지 확인
*   **TC-FS-031**: 전역 파일 검색을 통해 작업 공간 전체에서 파일을 검색할 수 있는지 확인
*   **TC-FS-032**: 다중 파일 선택이 올바르게 동작하는지 확인
*   **TC-FS-033**: 접근 권한이 없는 디렉토리 선택 시 적절한 오류 메시지가 표시되는지 확인
*   **TC-FS-034**: 대용량 디렉토리 처리 시 성능이 적절한지 확인

### 6. 관련 파일/모듈 (Related Files/Modules)

*   `main_window.py`: 메인 UI 및 디렉토리 선택 이벤트 처리
*   `widgets/directory_tree_widget.py`: 디렉토리 트리 위젯 구현
*   `widgets/file_list_widget.py`: 파일 목록 위젯 및 테이블 모델 구현
*   `core/tag_manager.py`: 파일 목록 조회 및 태그 정보 관리
*   `widgets/file_detail_widget.py`: 파일 상세 정보 표시
*   `widgets/tag_control_widget.py`: 태그 제어 위젯
*   `ui/main_window.ui`: 메인 윈도우 UI 레이아웃 정의

--- 