---
status: Approved
---
# 기능 명세 (Feature Specification)

*   **문서 ID**: `FS-20250711-001`
*   **작성일**: `2025년 07월 14일`
*   **작성자**: `Gemini (PM)`
*   **기능명**: `파일 태그 추가 및 일괄 추가`

---

### 1. 개요 (Overview)

*   이 기능의 목적은 사용자가 FileTagger 애플리케이션 내에서 파일에 태그를 부여하고, 필요에 따라 여러 파일에 동일한 태그를 효율적으로 일괄 추가할 수 있도록 하는 것입니다.
*   사용자가 파일을 쉽게 분류하고 검색할 수 있도록 하여 파일 관리의 편의성을 증대시킵니다.
*   이 기능은 FileTagger의 핵심 기능 중 하나로, 파일 검색 및 관리에 필수적인 역할을 합니다.

### 2. 주요 기능 상세 (Detailed Functional Description)

#### 2.1. 기능 설명:

*   **단일 파일 태그 추가**:
    *   사용자는 파일 상세 보기 화면 또는 파일 목록의 컨텍스트 메뉴를 통해 특정 파일에 태그를 추가할 수 있습니다.
    *   태그 추가 시, 기존에 정의된 태그 목록에서 선택하거나 새로운 태그를 직접 입력하여 생성할 수 있습니다.
    *   새로운 태그는 자동으로 시스템에 등록됩니다.
*   **일괄 태그 추가**:
    *   사용자는 파일 목록에서 여러 파일을 선택한 후, 선택된 모든 파일에 동일한 태그를 일괄적으로 추가할 수 있습니다.
    *   일괄 추가 시에도 기존 태그 목록에서 선택하거나 새로운 태그를 생성하여 사용할 수 있습니다.
    *   이미 해당 태그를 가지고 있는 파일에는 태그가 중복 추가되지 않습니다.

#### 2.2. 입력/출력:

*   **입력**:
    *   태그를 추가할 파일(들)의 경로 및 식별자.
    *   추가할 태그의 이름 (문자열).
*   **출력**:
    *   성공 시: 태그가 파일(들)에 성공적으로 추가되었음을 나타내는 메시지.
    *   실패 시: 오류 메시지 (예: 파일 없음, 태그 추가 실패 등).

#### 2.3. 정상 흐름:

1.  **단일 파일 태그 추가**:
    1.  사용자가 파일 목록에서 특정 파일을 선택합니다.
    2.  파일 상세 보기 화면으로 이동하거나, 컨텍스트 메뉴에서 "태그 추가" 옵션을 선택합니다.
    3.  태그 입력/선택 UI가 나타납니다.
    4.  사용자가 태그를 입력하거나 기존 태그 목록에서 선택합니다.
    5.  "추가" 버튼을 클릭합니다.
    6.  시스템은 해당 파일에 태그를 추가하고, 성공 메시지를 표시합니다.
2.  **일괄 태그 추가**:
    1.  사용자가 파일 목록에서 여러 파일을 선택합니다.
    2.  "일괄 태그 추가" 버튼 또는 컨텍스트 메뉴 옵션을 선택합니다.
    3.  일괄 태그 추가 UI가 나타납니다.
    4.  사용자가 추가할 태그를 입력하거나 기존 태그 목록에서 선택합니다.
    5.  "적용" 버튼을 클릭합니다.
    6.  시스템은 선택된 모든 파일에 해당 태그를 추가하고, 성공 메시지를 표시합니다. (이미 태그가 있는 파일은 건너뜀)

#### 2.4. 예외 처리:

*   **유효하지 않은 태그 이름**: 태그 이름이 비어있거나, 허용되지 않는 문자를 포함할 경우 오류 메시지 표시.
*   **파일 접근 권한 없음**: 파일에 태그를 추가할 권한이 없을 경우 오류 메시지 표시.
*   **데이터베이스 오류**: 태그 저장 중 데이터베이스 오류 발생 시 사용자에게 알림.
*   **일괄 추가 중 부분 실패**: 일괄 추가 중 일부 파일에서만 실패할 경우, 성공한 파일은 유지하고 실패한 파일에 대한 정보를 사용자에게 제공.

### 3. UI/UX 요소 (UI/UX Elements)

*   **파일 상세 보기 화면**: 태그를 추가/삭제할 수 있는 입력 필드 및 버튼 제공. 기존 태그 목록 자동 완성 기능.
*   **파일 목록 컨텍스트 메뉴**: "태그 추가" 및 "일괄 태그 추가" 옵션 제공.
*   **일괄 태그 추가 다이얼로그**: 선택된 파일 수 표시, 태그 입력 필드, 기존 태그 목록 드롭다운, "적용" 및 "취소" 버튼.
*   **태그 칩**: 추가된 태그는 시각적으로 구분되는 태그 칩 형태로 표시.

### 4. 기술적 구현 (Technical Implementation)

*   **백엔드 로직**: `TagManager` 또는 유사한 서비스 계층에서 태그 추가 및 일괄 추가 로직을 처리.
*   **데이터 모델**: `TaggedFile` 모델에 태그 정보를 저장하는 필드 추가 (예: 리스트 형태).
*   **데이터베이스 연동**: MongoDB를 사용하여 태그 정보 영속화. 파일 경로와 태그 목록을 매핑하여 저장.
*   **성능 고려**: 일괄 추가 시 대량의 파일 처리 성능 최적화 (예: 벌크 업데이트).

### 5. 테스트 케이스 (Test Cases)

*   **단일 태그 추가**:
    *   새로운 태그를 성공적으로 추가.
    *   기존 태그를 성공적으로 추가.
    *   이미 존재하는 태그를 다시 추가 시 중복 방지.
    *   유효하지 않은 태그 이름 (빈 문자열, 특수 문자) 입력 시 오류 처리.
*   **일괄 태그 추가**:
    *   여러 파일에 새로운 태그를 성공적으로 일괄 추가.
    *   여러 파일에 기존 태그를 성공적으로 일괄 추가.
    *   선택된 파일 중 일부에 이미 태그가 있는 경우, 해당 파일은 건너뛰고 나머지 파일에만 태그 추가.
    *   선택된 모든 파일에 이미 태그가 있는 경우, 아무것도 변경되지 않음을 확인.
    *   일괄 추가 중 네트워크/DB 오류 발생 시 예외 처리.

### 6. 관련 파일/모듈 (Related Files/Modules)

*   `main_window.py`: 메인 UI 및 이벤트 핸들링.
*   `ui/`: 태그 추가 및 일괄 추가 관련 UI 파일 (예: `tag_control_widget.ui`, `batch_tagging_options_widget.ui`).
*   `widgets/`: 관련 위젯 구현 (예: `tag_control_widget.py`, `batch_tagging_options_widget.py`).
*   `core/tag_manager.py`: 태그 추가/삭제 등 핵심 비즈니스 로직.
*   `models/tagged_file.py`: 태그된 파일 데이터 모델.
*   `viewmodels/`: 관련 뷰모델 (예: `file_detail_viewmodel.py`, `file_list_viewmodel.py`).

---